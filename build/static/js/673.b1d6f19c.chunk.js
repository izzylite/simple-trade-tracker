"use strict";(self.webpackChunkjournotrades=self.webpackChunkjournotrades||[]).push([[673],{79673:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var n=r(65043),o=r(91283),i=r(53969),a=r(80172),s=r(55895),l=r(91449),c=r(35054),u=r(78018),g=r(70579);const h=()=>{const e=(0,o.Zp)(),[t]=(0,o.ok)(),[r,h]=(0,n.useState)(null),[d,f]=(0,n.useState)(!0),A=(0,n.useRef)(!1);return(0,n.useEffect)((()=>{u.logger.info("AuthCallback: Starting callback handling"),u.logger.info("AuthCallback: Current URL:",window.location.href),u.logger.info("AuthCallback: Search params:",Object.fromEntries(t.entries()));const r=t.get("error"),n=t.get("error_description");if(r)return u.logger.error("OAuth error:",r,n),h(n||r),void f(!1);const o=t.has("code");u.logger.info("AuthCallback: Has code param:",o);const{data:{subscription:i}}=c.N.auth.onAuthStateChange(((t,r)=>{u.logger.info("AuthCallback: Auth event received:",t),A.current||("SIGNED_IN"===t&&r?(u.logger.info("Authentication successful via SIGNED_IN event"),u.logger.info("Session user:",r.user.email),A.current=!0,e("/dashboard",{replace:!0})):"INITIAL_SESSION"===t&&r?(u.logger.info("Authentication successful via INITIAL_SESSION event"),u.logger.info("Session user:",r.user.email),A.current=!0,e("/dashboard",{replace:!0})):"INITIAL_SESSION"!==t||r||(o?u.logger.info("AuthCallback: No session yet, but code present - waiting for PKCE exchange"):(u.logger.info("AuthCallback: No code and no session - redirecting to home"),A.current=!0,e("/",{replace:!0}))))}));let a;return o&&(a=setTimeout((()=>{A.current||(u.logger.error("AuthCallback: PKCE code exchange timeout"),h("Authentication timed out. Please try signing in again."),f(!1))}),15e3)),()=>{u.logger.info("AuthCallback: Cleaning up auth listener"),i.unsubscribe(),a&&clearTimeout(a)}}),[e,t]),(0,n.useEffect)((()=>{if(r){const t=setTimeout((()=>{e("/",{replace:!0})}),5e3);return()=>clearTimeout(t)}}),[r,e]),d?(0,g.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",gap:2,px:2},children:[(0,g.jsx)(a.A,{size:48}),(0,g.jsx)(s.A,{variant:"h6",color:"text.secondary",children:"Completing sign in..."}),(0,g.jsx)(s.A,{variant:"body2",color:"text.secondary",textAlign:"center",children:"Please wait while we finish setting up your account."})]}):r?(0,g.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",gap:2,px:2,maxWidth:500,mx:"auto"},children:[(0,g.jsxs)(l.A,{severity:"error",sx:{width:"100%"},children:[(0,g.jsx)(s.A,{variant:"h6",gutterBottom:!0,children:"Authentication Failed"}),(0,g.jsx)(s.A,{variant:"body2",children:r})]}),(0,g.jsx)(s.A,{variant:"body2",color:"text.secondary",textAlign:"center",children:"You will be redirected to the home page in a few seconds."})]}):null}}}]);
//# sourceMappingURL=673.b1d6f19c.chunk.js.map